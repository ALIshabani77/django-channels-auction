# ๐ ุชุณฺฉ ูู ุฌูฺฏู: ุณุณุชู ุญุฑุงุฌ ุฒูุฏู (ุณูุงุฑู ฒ)

ุงู ูพุฑูฺู ฺฉ API ุจุฑุง ุณุณุชู ุญุฑุงุฌ ุฒูุฏู ุงุณุช ฺฉู ุจุง ุงุณุชูุงุฏู ุงุฒ Djangoุ DRF ู Django Channels ูพุงุฏูโุณุงุฒ ุดุฏู ุงุณุช. ฺุงูุด ุงุตู ุงู ุชุณฺฉุ ูุฏุฑุช ููุฒูุงู (Concurrency) ุจุฑุง ุฌููฺฏุฑ ุงุฒ Race Condition ู ุงุทูุงุนโุฑุณุงู ูุญุธูโุง (Real-time) ููุชโูุง ุฌุฏุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ WebSockets ุจูุฏ.

ุงู ูพุฑูฺู ุจู ุตูุฑุช ฺฉุงูู ุจุง Docker ู Docker Compose ฺฉุงูุชูุฑุฒู ุดุฏู ุงุณุช.

---

## ๐๏ธ ูพุดุชู ููุงูุฑ (Tech Stack)

* **Backend:** Django, Django REST Framework
* **Real-time:** Django Channels
* **Database:** PostgreSQL (ุจุฑุง ุฏุงุฏูโูุง ุงุตู)
* **Message Broker:** Redis (ุจุฑุง ูุงู `ChannelLayer`)
* **Server:** Gunicorn + Uvicorn
* **Containerization:** Docker & Docker Compose

---

## โจ ูฺฺฏโูุง ฺฉูุฏ

* **API ฺฉุงูู:** ุดุงูู Endpoints ุจุฑุง ูุดุงูุฏู ูุณุช ุญุฑุงุฌโูุง ู ุซุจุช ูพุดููุงุฏ (`bid`).
* **ุฌููฺฏุฑ ุงุฒ Race Condition:** ุจุง ุงุณุชูุงุฏู ุงุฒ `transaction.atomic()` ู `select_for_update()` ุฏุฑ ุณุทุญ ุฏุชุงุจุณุ ุชุถูู ูโุดูุฏ ฺฉู ุฏู ฺฉุงุฑุจุฑ ููโุชูุงููุฏ ููุฒูุงู ฺฉ ูพุดููุงุฏ ุฑุง ุซุจุช ฺฉููุฏ ู ุฏุงุฏูโูุง ุจู ุตูุฑุช ุงูู (Thread-safe) ูพุฑุฏุงุฒุด ูโุดููุฏ.
* **ุงุทูุงุนโุฑุณุงู ูุญุธูโุง:** ูุฑ ูพุดููุงุฏ ูููู ุจูุงูุงุตูู ุงุฒ ุทุฑู WebSockets ุจู ุชูุงู ฺฉุงุฑุจุฑุงู ูุชุตู ุจู ุขู ุญุฑุงุฌ (ฺฏุฑูู) Broadcast ูโุดูุฏ.
* **ุขูุงุฏู ุงุฌุฑุง:** ุฑุงูโุงูุฏุงุฒ ฺฉู ูพุฑูฺู (ุดุงูู ูุจโุณุฑูุฑุ ุฏุชุงุจุณ ู ุฑุฏุณ) ููุท ุจุง ฺฉ ุฏุณุชูุฑ.

---

## ๐ ุฑุงูโุงูุฏุงุฒ ู ุงุฌุฑุง

**ูพุดโูุงุฒ:**
* Docker
* Docker Compose

**ูุฑุงุญู ุงุฌุฑุง:**

1.  **ฺฉููู ฺฉุฑุฏู ูพุฑูฺู:**
    ```bash
    git clone [ุขุฏุฑุณ ุฑูพุงุฒุชูุฑ ฺฏุชโูุงุจ ุดูุง]
    cd [ุงุณู ูพูุดู ูพุฑูฺู ุดูุง]
    ```

2.  **ุงุฌุฑุง Docker Compose:**
    ุงู ุฏุณุชูุฑ ุชูุงู ุณุฑูุณโูุง (`web`, `db`, `redis`) ุฑุง ุจูุฏ ฺฉุฑุฏูุ `migrate` ุฑุง ุงุฌุฑุง ูโฺฉูุฏ ู ุณุฑูุฑ ุฑุง ุฑู ูพูุฑุช 8000 ุฑูุดู ูโฺฉูุฏ.
    ```bash
    docker compose up --build
    ```
    ูพุฑูฺู ููโุงฺฉููู ุฑู `http://localhost:8000` ุฏุฑ ุฏุณุชุฑุณ ุงุณุช.

3.  **(ุงุฎุชุงุฑ) ุณุงุฎุช Superuser:**
    ุจุฑุง ุฏุณุชุฑุณ ุจู ูพูู ุงุฏูู (`/admin/`)ุ ุฏุฑ ฺฉ **ุชุฑููุงู ุฌุฏุฏ** ุงู ุฏุณุชูุฑ ุฑุง ุงุฌุฑุง ฺฉูุฏ:
    ```bash
    docker compose run --rm web python manage.py createsuperuser
    ```

---

## ๐ ูุณุชูุฏุงุช API

### ฑ. ูุณุช ฺฉุฑุฏู ุขุชูโูุง ุญุฑุงุฌ ูุนุงู

ูุณุช ุงุฒ ุชูุงู ุขุชูโูุง ฺฉู ุฒูุงู ุญุฑุงุฌ ุขูโูุง ูููุฒ ุชูุงู ูุดุฏู ุงุณุช ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ.

* **Endpoint:** `GET /api/items/`
* **ูุชุฏ:** `GET`
* **ูพุงุณุฎ ููููุชโุขูุฒ (200 OK):**
    ```json
    [
        {
            "id": 1,
            "name": "ุชุณุช ุขุชู ฑ",
            "description": "ุชูุถุญุงุช...",
            "current_price": "100.00",
            "ends_at": "2025-11-09T19:19:04Z",
            "is_active": true,
            "updated_at": "2025-11-07T19:19:20Z"
        }
    ]
    ```

### ฒ. ุซุจุช ูพุดููุงุฏ ุฌุฏุฏ (Bid)

ฺฉ ูพุดููุงุฏ ุฌุฏุฏ ุจุฑุง ุขุชู ูุดุฎุต ุดุฏู ุซุจุช ูโฺฉูุฏ.

* **Endpoint:** `POST /api/items/<int:item_id>/bid/`
* **ูุชุฏ:** `POST`
* **ุจุฏูู ุฏุฑุฎูุงุณุช (Body) (JSON):**
    ```json
    {
        "amount": "150.00"
    }
    ```
* **ูพุงุณุฎ ููููุชโุขูุฒ (200 OK):**
    (ุขุจุฌฺฉุช ุขูพุฏุช ุดุฏู ุขุชู ุฑุง ุจุฑูโฺฏุฑุฏุงูุฏ)
    ```json
    {
        "id": 1,
        "name": "ุชุณุช ุขุชู ฑ",
        "current_price": "150.00",
        ...
    }
    ```
* **ูพุงุณุฎโูุง ุฎุทุง (400 Bad Request):**
    ```json
    {"error": "This auction has ended."}
    ```
    ```json
    {"error": "Bid must be higher than the current price (100.00)."}
    ```

---

## ๐ ูุณุชูุฏุงุช WebSocket

* **ุขุฏุฑุณ ุงุชุตุงู:** `ws://localhost:8000/ws/auction/<int:item_id>/`

### ูพุงูโูุง ุฏุฑุงูุช (ุงุฒ ุณุฑูุฑ ุจู ฺฉูุงูุช)

ูุฑฺฏุงู ฺฉ ูพุดููุงุฏ ุฌุฏุฏ ุงุฒ ุทุฑู API ุซุจุช ุดูุฏุ ุณุฑูุฑ ุจูุงูุงุตูู ุงู ูพุงู ุฑุง ุจุฑุง ุชูุงู ฺฉูุงูุชโูุง ูุชุตู ุจู ุขู ุงุชุงู (`item_id`) ุงุฑุณุงู ูโฺฉูุฏ:

* **ูพุงู:** `new_price`
* **ูุซุงู:**
    ```json
    {
        "new_price": "150.00"
    }
    ```
